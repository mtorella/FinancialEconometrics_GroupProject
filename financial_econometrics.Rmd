---
title: "Financial Econometrics - Group Assignment"
output:
  html_document: default
  #pdf_document: default
---

# Varianza Italiana {.tabset .tabset-fade}

Group members:

-   Baldoni Chiara
-   Pinna Paola
-   Torella Marta 

## EDA {.tabset .tabset-fade}

```{r}
data <- read.csv("FIN 36182-Industry_Portfolios.CSV")
head(data)
sum(is.na(data))
anyDuplicated(data)

data[, 2:6] <- data[, 2:6] / 100 ## Convert returns to decimal form as asked
head(data)
```
## Task 1 {.tabset .tabset-fade}

### 1. Report the arithmetic mean of the returns for each of the five industries over the entire sample

```{r}
monthly_means <- colMeans(data[, c("Cnsmr", "Manuf", "HiTec", "Hlth", "Other")]) 
annualized_means <- monthly_means * 12
annualized_means <- round(annualized_means, 4)
annualized_means
```

### 2. Report the standard deviation of the returns for each of the five industries over the entire sample

```{r}
monthly_std <- apply(data[, c("Cnsmr", "Manuf", "HiTec", "Hlth", "Other")], 2, sd)
annualized_std <- monthly_std * sqrt(12)
annualized_std <- round(annualized_std, 4)
annualized_std
```

### 3. Report the Sharpe ratio of each industry

```{r}
sharpe_ratios <- annualized_means / annualized_std
sharpe_ratios <- round(sharpe_ratios, 4)
sharpe_ratios
```

```{r}
results_table1 <- data.frame(
  Mean_Returns = annualized_means,
  Std_Returns = annualized_std,
  Sharpe_Ratio = sharpe_ratios
 )
results_table1
```

### 4. Is there evidence that technology stocks have better risk-adjusted returns?
Based on the results, technology stocks (HiTec) have a Sharpe ratio of 0.6216, indicating better risk-adjusted returns compared to the manufacturing (0.6045) and other sectors (0.4994). However, they do not outperform the consumer (0.6646) and health industries (0.6746), which exhibit higher Sharpe ratios. Therefore, while technology stocks offer relatively good risk-adjusted returns, they are not the best performers overall, as both the consumer and health sectors deliver better risk-adjusted outcomes.

### 5. Provide a table (5×5) with the sample correlation between the returns of the five industries. Comment briefly.

```{r}
correlation_matrix <- cor(data[, c("Cnsmr", "Manuf", "HiTec", "Hlth", "Other")])
correlation_matrix <- round(correlation_matrix, 4)
correlation_matrix
```

```{r, warning=FALSE, message=FALSE}
library(knitr)
kable(correlation_matrix, caption = "Correlation Matrix of Industry Returns", format = "html")
library(corrplot)
corrplot(correlation_matrix, method = "color", type = "upper", 
         tl.col = "black", tl.srt = 45, 
         addCoef.col = "black",  
         number.cex = 0.8,       
         number.digits = 2)      

```

The correlation matrix indicates that all five industries have positive correlations with each other, suggesting that their returns tend to move in the same direction. The strongest correlations are between Manufacturing and Other (0.8924) and between Manufacturing and Consumer (0.8670), indicating that these industries have highly synchronized return movements. On the other hand, the weakest correlations are between Technology and Health (0.7072), and between these two industries and the others, implying that Technology and Health exhibit slightly more independent return patterns. While the positive correlations across all industries suggest some degree of co-movement, the relatively lower correlations for Technology and Health indicate potential diversification benefits, though the absence of negative correlations limits the extent of diversification.

### 6. Construct a time series of the simple, non-cumulative returns of a portfolio where capital is allocated equally across the first four industries (excluding Other). Report the arithmetic mean, standard deviation and Sharpe. Comment briefly on the gains achieved by this diversified portfolio.

```{r, warning=FALSE, message=FALSE}
portfolio_returns <- rowMeans(data[, c("Cnsmr", "Manuf", "HiTec", "Hlth")]) 
data$Portfolio_Returns <- portfolio_returns
mean_portfolio <- mean(portfolio_returns)
sd_portfolio <- sd(portfolio_returns)

annualized_mean_portfolio <- mean_portfolio * 12
annualized_sd_portfolio <- sd_portfolio * sqrt(12)
sharpe_ratio_portfolio <- annualized_mean_portfolio / annualized_sd_portfolio

portfolio_results <- data.frame(
  Metric = c("Annualized Mean Return", "Annualized Standard Deviation", "Sharpe Ratio"),
  Value = round(c(annualized_mean_portfolio, annualized_sd_portfolio, sharpe_ratio_portfolio), 4)
)
print(portfolio_results)
```

The diversified portfolio, which allocates capital equally across the first four industries, achieves an annualized mean return of 12.14% and an annualized standard deviation of 17.34%, resulting in a Sharpe ratio of 0.7004. This Sharpe ratio indicates that the portfolio offers better risk-adjusted returns than some individual industries, such as Manufacturing (0.6045) and Other (0.4994). It also slightly outperforms Technology (0.6216), suggesting that diversification has improved the portfolio’s performance relative to risk. However, the gains from diversification are not substantial, as the portfolio’s Sharpe ratio is only marginally higher than that of Health (0.6746) and Consumer (0.6646). Overall, diversification provides some benefit, but the improvement in risk-adjusted returns is moderate.

```{r, warning=FALSE, message=FALSE}
library(ggplot2)
data$Date <- as.character(data$Date)
data$Date <- paste0(data$Date, "01")
data$Date <- as.Date(data$Date, format = "%Y%m%d")

plot_data <- data.frame(Date = data$Date, Portfolio_Returns = data$Portfolio_Returns)
ggplot(plot_data, aes(x = Date, y = Portfolio_Returns)) +
  geom_line(color = "blue") +
  labs(title = "Portfolio Returns Over Time",
       x = "Date",
       y = "Portfolio Returns") +
  theme_minimal()
```

The portfolio returns exhibit significant volatility, especially in the earlier periods before the 1950s, with large spikes in both positive and negative directions. This high volatility is particularly evident around historical market crashes, such as the Great Depression in the 1930s and the 2008 financial crisis. After World War II, the portfolio returns become more stable, with fewer extreme fluctuations, though volatility remains, particularly during financial crises. In the last two decades, there has been a noticeable increase in volatility, likely reflecting events like the dot-com bubble, the 2008 crisis, and the COVID-19 market disruptions. Overall, while the portfolio appears more stable post-1950, significant market events continue to cause sharp fluctuations.

## Task 2 {.tabset .tabset-fade}
In this task you will treat the portfolio you computed in Task 1, point (6), as the market portfolio, denote its returns as Rm, and will estimate and interpret beta and alpha coefficients in the context of the CAPM.

### 1. Compute the kurtosis and skeweness of Rm
```{r, warning=FALSE, message=FALSE}
library(moments)

skewness_value <- skewness(data$Portfolio_Returns, na.rm = TRUE)
kurtosis_value <- kurtosis(data$Portfolio_Returns, na.rm = TRUE)

kurtosis_value <- round(kurtosis_value, 4)
skewness_value <- round(skewness_value, 4)

portfolio_results2 <- data.frame(
  Metric = c("Kurtosis", "Skewness"),
  Value = c(kurtosis_value, skewness_value)
)
print(portfolio_results2)
```

```{r, warning=FALSE, message=FALSE}
library(ggplot2)
ggplot(data = data.frame(returns = data$Portfolio_Returns), aes(x = returns)) +
  geom_histogram(aes(y = ..density..), bins = 30, fill = "blue", color = "black", alpha = 0.7) +
  geom_density(color = "red", size = 1) +
  stat_function(fun = dnorm, 
                args = list(mean = mean(portfolio_returns, na.rm = TRUE), 
                            sd = sd(portfolio_returns, na.rm = TRUE)),
                color = "green", linetype = "dashed", size = 1) +
  labs(title = "Distribution of Portfolio Returns with Normal Distribution Overlay",
       x = "Portfolio Returns",
       y = "Density") + 
  theme_minimal()
```


### 2. How do the values in (1) compare with the normal distribution?
The portfolio returns exhibit a kurtosis of 10.2856, which is significantly higher than the normal distribution’s kurtosis of 3, indicating the presence of fat tails. This suggests that the portfolio is more likely to experience extreme returns, both positive and negative, compared to a normal distribution. In contrast, the skewness of 0.0237 is very close to zero, implying that the distribution of returns is symmetric, with no significant bias toward either side. Overall, while the portfolio returns are prone to extreme fluctuations, these events are equally likely to be positive or negative, reflecting a balance in the distribution’s shape.

Moreover, the above plot shows the distribution of portfolio returns (blue histogram with red density curve) overlaid with a normal distribution (green dashed line). The portfolio returns exhibit fatter tails compared to the normal distribution, particularly on the left side, which is consistent with the high kurtosis observed earlier, indicating a higher probability of extreme returns. The distribution is also roughly symmetric, aligning with the nearly zero skewness, showing no significant bias toward either positive or negative returns. Additionally, the portfolio’s return distribution has a slightly higher peak than the normal curve, suggesting a greater concentration of returns near the mean. Overall, the portfolio returns deviate from the normal distribution, with a greater chance of extreme events and a higher central concentration of values.

### 3. Repeat point (1), but eliminating the first 70 years of data (i.e. from 199706).

```{r}
data_filtered <- data[data$Date >= as.Date("1997-06-01"), ]
portfolio_returns_filtered <- data_filtered$Portfolio_Returns

skewness_filtered <- skewness(portfolio_returns_filtered, na.rm = TRUE)
kurtosis_filtered <- kurtosis(portfolio_returns_filtered, na.rm = TRUE)

skewness_filtered <- round(skewness_filtered, 4)
kurtosis_filtered <- round(kurtosis_filtered, 4)

portfolio_results3 <- data.frame(
  Metric = c("Kurtosis", "Skewness"),
  Value = c(kurtosis_filtered, skewness_filtered)
)
print(portfolio_results3)
```

```{r}
ggplot(data = data.frame(returns = portfolio_returns_filtered), aes(x = returns)) +
  geom_histogram(aes(y = after_stat(density)), bins = 30, fill = "blue", color = "black", alpha = 0.7) +
  geom_density(color = "red", linewidth = 1) +
  stat_function(fun = dnorm, 
                args = list(mean = mean(portfolio_returns_filtered, na.rm = TRUE), 
                            sd = sd(portfolio_returns_filtered, na.rm = TRUE)),
                color = "green", linetype = "dashed", linewidth = 1) +
  labs(title = "Distribution of Filtered Portfolio Returns with Normal Distribution Overlay",
       x = "Portfolio Returns",
       y = "Density") +
  theme_minimal()
```

### 4. Compute and report the covariance of the first four industries with Rm

```{r}
cov_Cnsmr_Rm <- cov(data$Cnsmr, data$Portfolio_Returns, use = "complete.obs")
cov_Manuf_Rm <- cov(data$Manuf, data$Portfolio_Returns, use = "complete.obs")
cov_HiTec_Rm <- cov(data$HiTec, data$Portfolio_Returns, use = "complete.obs")
cov_Hlth_Rm <- cov(data$Hlth, data$Portfolio_Returns, use = "complete.obs")

cov_Cnsmr_Rm <- round(cov_Cnsmr_Rm, 4)
cov_Manuf_Rm <- round(cov_Manuf_Rm, 4)
cov_HiTec_Rm <- round(cov_HiTec_Rm, 4)
cov_Hlth_Rm <- round(cov_Hlth_Rm, 4)

covariances <- data.frame(
  Industry = c("Cnsmr", "Manuf", "HiTec", "Hlth"),
  Covariance_with_Rm = c(cov_Cnsmr_Rm, cov_Manuf_Rm, cov_HiTec_Rm, cov_Hlth_Rm)
)

print(covariances)
```

### 5. Use the results obtained so far to compute the beta values for the first four industries for the full sample

```{r}
# calculate the variance of the portfolio returns (Rm)
var_Rm <- var(data$Portfolio_Returns, use = "complete.obs")
var_Rm <- round(var_Rm, 4)

# calculate the beta values for each industry
beta_Cnsmr <- cov_Cnsmr_Rm / var_Rm
beta_Manuf <- cov_Manuf_Rm / var_Rm
beta_HiTec <- cov_HiTec_Rm / var_Rm
beta_Hlth <- cov_Hlth_Rm / var_Rm

beta_Cnsmr <- round(beta_Cnsmr, 4)
beta_Manuf <- round(beta_Manuf, 4)
beta_HiTec <- round(beta_HiTec, 4)
beta_Hlth <- round(beta_Hlth, 4)

beta_values <- data.frame(
  Industry = c("Cnsmr", "Manuf", "HiTec", "Hlth"),
  Beta = c(beta_Cnsmr, beta_Manuf, beta_HiTec, beta_Hlth)
)
print(beta_values)
```

### 6. Compute the beta values for the first four industries for the sample starting from 199706. Briefly comment on how results compare with those in point (5)

```{r}
var_Rm_filtered <- var(portfolio_returns_filtered, use = "complete.obs")

beta_Cnsmr_filtered <- cov(data_filtered$Cnsmr, data_filtered$Portfolio_Returns, use = "complete.obs") / var_Rm_filtered
beta_Manuf_filtered <- cov(data_filtered$Manuf, data_filtered$Portfolio_Returns, use = "complete.obs") / var_Rm_filtered
beta_HiTec_filtered <- cov(data_filtered$HiTec, data_filtered$Portfolio_Returns, use = "complete.obs") / var_Rm_filtered
beta_Hlth_filtered <- cov(data_filtered$Hlth, data_filtered$Portfolio_Returns, use = "complete.obs") / var_Rm_filtered

beta_Cnsmr_filtered <- round(beta_Cnsmr_filtered, 4)
beta_Manuf_filtered <- round(beta_Manuf_filtered, 4)
beta_HiTec_filtered <- round(beta_HiTec_filtered, 4)
beta_Hlth_filtered <- round(beta_Hlth_filtered, 4)

beta_values_filtered <- data.frame(
  Industry = c("Cnsmr", "Manuf", "HiTec", "Hlth"),
  Beta_Filtered = c(beta_Cnsmr_filtered, beta_Manuf_filtered, beta_HiTec_filtered, beta_Hlth_filtered)
)
print(beta_values_filtered)
```

```{r}
comparison <- data.frame(
  Industry = c("Cnsmr", "Manuf", "HiTec", "Hlth"),
  Beta_Full_Sample = c(beta_Cnsmr, beta_Manuf, beta_HiTec, beta_Hlth),  # point 5
  Beta_Filtered = c(beta_Cnsmr_filtered, beta_Manuf_filtered, beta_HiTec_filtered, beta_Hlth_filtered)  # point 6
)
print(comparison)
```

The comparison of beta values between the full sample and the post-June 1997 period shows some notable changes. For Consumer stocks, the beta decreases from 1.00 in the full sample to 0.9236 in the filtered period, indicating slightly less sensitivity to the market. Similarly, Manufacturing shows a reduction in beta from 1.04 to 0.9533, suggesting that its returns are less volatile relative to the market in the more recent period. In contrast, Technology stocks see a significant increase in beta from 1.00 to 1.3305, implying a stronger reaction to market movements in the post-1997 period. Lastly, Health stocks exhibit a lower beta, decreasing from 0.96 to 0.7926, indicating that they have become less sensitive to market fluctuations. Overall, the results suggest that Technology has become more volatile relative to the market, while the other industries show reduced sensitivity in the more recent period.

### 7. Assuming a risk-free rate of 5%, compute Jensen’s alpha for each of the first four industries (on the full sample). Report the alpha in percentage terms. Briefly discuss your results

```{r}
annualized_returns_industries <- annualized_means
risk_free_rate <- 0.05

alpha_Cnsmr <- (annualized_returns_industries["Cnsmr"] - (risk_free_rate + beta_Cnsmr * (annualized_mean_portfolio - risk_free_rate))) * 100
alpha_Manuf <- (annualized_returns_industries["Manuf"] - (risk_free_rate + beta_Manuf * (annualized_mean_portfolio - risk_free_rate))) * 100
alpha_HiTec <- (annualized_returns_industries["HiTec"] - (risk_free_rate + beta_HiTec * (annualized_mean_portfolio - risk_free_rate))) * 100
alpha_Hlth <- (annualized_returns_industries["Hlth"] - (risk_free_rate + beta_Hlth * (annualized_mean_portfolio - risk_free_rate))) * 100

jensens_alpha <- data.frame(
  Industry = c("Cnsmr", "Manuf", "HiTec", "Hlth"),
  Alpha = round(c(alpha_Cnsmr, alpha_Manuf, alpha_HiTec, alpha_Hlth), 4)
)
print(jensens_alpha)
```

The Jensen’s alpha results, reported in percentage terms, show varying performance across the four industries. Consumer stocks have an alpha of 0.0051%, indicating performance roughly in line with expectations under the CAPM model. Manufacturing stocks, on the other hand, have a negative alpha of -0.9107%, meaning they significantly underperformed relative to what the CAPM would predict. Similarly, Technology stocks exhibit a negative alpha of -0.1149%, suggesting a slight underperformance. In contrast, Health stocks stand out with a positive alpha of 1.0209%, indicating that this sector outperformed its expected return by over 1%, given its risk and the market conditions. Overall, the Health sector performed well above expectations, while Manufacturing and Technology stocks underperformed.

## Task 3 {.tabset .tabset-fade}
Use the lm( ) function to run a few regressions:

### 1. Regress Rm(t) on an intercept and on Rm(t−1). Report estimates and t-statistics. Briefly interpret the results

```{r}
library(dplyr)
data <- data %>%
  mutate(Rm_lag = lag(Portfolio_Returns, 1))
head(data)
```

```{r}
model <- lm(Portfolio_Returns ~ Rm_lag, data = data)
summary(model)
```


```{r, warning=FALSE, message=FALSE}
library(ggplot2)
ggplot(data, aes(x = Rm_lag, y = Portfolio_Returns)) +
  geom_point(color = "blue", alpha = 0.6) +  # Scatter plot of returns
  geom_smooth(method = "lm", color = "red", se = FALSE) +  # Regression line without confidence interval
  labs(title = "Regression of Portfolio Returns on Lagged Returns",
       x = "Lagged Portfolio Returns (R_m(t-1))",
       y = "Portfolio Returns (R_m(t))") +
  theme_minimal()
```

The regression of current portfolio returns Rm(t) on lagged returns Rm(t-1) shows a small but significant positive relationship. The coefficient for the lagged returns is 0.0809, indicating that for every 1-unit increase in the lagged returns, the current returns increase by about 0.0809 units. This coefficient is statistically significant (p-value = 0.00552), meaning that the relationship between lagged and current returns is unlikely to be due to chance.
However, the R-squared value is very low, at only 0.65%, suggesting that the lagged returns explain only a tiny fraction of the variation in current returns. Most of the variability in the portfolio returns is not captured by the lagged returns, indicating that other factors or random fluctuations have a much larger influence.
The intercept is 0.009287 and is highly significant (p-value = 5.76 \ times 10^{-10}), suggesting that even when the lagged returns are zero, the portfolio tends to produce a small positive return of about 0.93%. While the lagged returns do show some predictive power, their overall effect on current returns is weak, as evidenced by the low explanatory power of the model.

### 2. Regress Rm(t) on an intercept and on (Pm(t−1)/Pm(t−13)−1). Report estimates and t-statistics. Briefly interpret the results

```{r, warning=FALSE, message=FALSE}
data <- data %>%
  mutate(
    Rm_lag13 = lag(Portfolio_Returns, 13),  
    Return_Ratio = (Rm_lag / Rm_lag13) - 1  
  )
head(data,20)
```

```{r}
model_2 <- lm(Portfolio_Returns ~ Return_Ratio, data = data)
summary(model_2)
```

```{r, warning=FALSE, message=FALSE}
ggplot(data, aes(x = Return_Ratio, y = Portfolio_Returns)) +
  geom_point(color = "blue", alpha = 0.6) + 
  geom_smooth(method = "lm", color = "red", se = FALSE) +  
  labs(title = "Regression of Portfolio Returns on Return Ratio",
       x = "Return Ratio (R_m(t-1) / R_m(t-13) - 1)",
       y = "Portfolio Returns (R_m(t))") +
  theme_minimal()
```

The regression of portfolio returns Rm(t) on the return ratio (Rm(t−1)/Rm(t−13)−1) shows that the intercept is 0.99%, which is statistically significant with a t-value of 6.723 and a p-value of 0.69, indicating a positive baseline return when the return ratio is zero. However, the coefficient for the return ratio is -0.00003002, with a t-value of -0.399 and a p-value of 0.69, suggesting that the return ratio is not a significant predictor of current portfolio returns. The R-squared value is extremely low at 0.0001372, indicating that the return ratio explains only 0.01% of the variation in returns, and the adjusted R-squared is negative, further confirming the poor fit of the model. The F-statistic of 0.1593 and its p-value of 0.69 also indicate that the overall model is not statistically significant. In conclusion, the return ratio provides no meaningful explanatory power for current portfolio returns, and other factors likely drive the variation in returns.

### 3. Are the t-statistics reported by lm( ) in (2) reliable? Explain

Based on the results of your regression model where Rm(t) is regressed on (Rm(t−1)/Rm(t−13)−1), the t-statistics reported by lm() are likely not reliable. The model shows a very low R-squared value (0.0001372), indicating that the independent variable explains almost none of the variation in the dependent variable. Additionally, the coefficient for the return ratio is extremely close to zero and statistically insignificant (p-value = 0.69). This suggests that the model provides very little explanatory power. Furthermore, because you’re dealing with time series data, there’s a strong possibility of autocorrelation in the residuals, which violates one of the key assumptions of ordinary least squares (OLS) regression. Autocorrelation can lead to underestimated or overestimated standard errors, making the t-statistics unreliable. Therefore, without further diagnostic checks for autocorrelation or heteroscedasticity, the t-statistics reported by lm() should be treated with caution, and it’s likely that they do not provide an accurate assessment of the significance of the coefficients.

### 4. Regress Rm(t) on an intercept and on abs(Rm(t)). Report estimates and t-statistics. Briefly interpret the results

```{r message=FALSE, warning=FALSE}
data <- data %>%
  mutate(abs_Rm = abs(Portfolio_Returns))
head(data)
```

```{r}
model_3 <- lm(Portfolio_Returns ~ abs_Rm, data = data)
summary(model_3)
```

```{r, warning=FALSE, message=FALSE}
ggplot(data, aes(x = abs_Rm, y = Portfolio_Returns)) +
  geom_point(color = "blue", alpha = 0.6) +  # Scatter plot of returns
  geom_smooth(method = "lm", color = "red", se = FALSE) +  # Regression line without confidence interval
  labs(title = "Regression of Portfolio Returns on Absolute Returns",
       x = "Absolute Returns (abs(R_m(t)))",
       y = "Portfolio Returns (R_m(t))") +
  theme_minimal()
```

The regression of portfolio returns Rm(t) on the absolute value of returns abs(Rm(t)) reveals some notable findings. The intercept is estimated at 0.003313 (approximately 0.33%), but it is not statistically significant, with a t-value of 1.573 and a p-value of 0.116, suggesting that the expected return when the absolute value of returns is zero is not different from zero in a statistically significant way. However, the coefficient for abs(Rm(t)) is estimated at 0.18372, which is statistically significant with a t-value of 4.454 and a p-value of 9.22e-06. This implies that larger absolute returns (whether positive or negative) are associated with higher current returns, indicating a relationship between volatility (represented by absolute returns) and current portfolio returns. The R-squared value of 0.01662 is low, meaning that only about 1.66% of the variation in portfolio returns is explained by the absolute value of returns. While the relationship between volatility and returns is statistically significant, the explanatory power of the model is limited, suggesting other factors likely play a more substantial role in determining portfolio returns.

### 5. Repeat (1) on data from 199706. (Delete all data prior to 199706, then compute lagged returns). Comment briefly

```{r}
data_filtered <- data %>%
  filter(Date >= as.Date("1997-06-01"))

data_filtered <- data_filtered %>%
  mutate(Rm_lag = lag(Portfolio_Returns, 1))

head(data_filtered)
```

```{r}
model_filtered <- lm(Portfolio_Returns ~ Rm_lag, data = data_filtered)
summary(model_filtered)
```

```{r, warning=FALSE, message=FALSE}
ggplot(data_filtered, aes(x = Rm_lag, y = Portfolio_Returns)) +
  geom_point(color = "blue", alpha = 0.6) +  
  geom_smooth(method = "lm", color = "red", se = FALSE) +  
  labs(title = "Regression of Portfolio Returns on Lagged Returns (Post-1997)",
       x = "Lagged Portfolio Returns (R_m(t-1))",
       y = "Portfolio Returns (R_m(t))") +
  theme_minimal()

```

The regression of portfolio returns Rm(t) on lagged returns Rm(t-1), using data from June 1997 onward, shows that the intercept is significant, estimated at 0.91% with a p-value of 0.000182, indicating a positive expected return when lagged returns are zero. However, the coefficient for lagged returns is -0.008882, with a t-value of -0.160 and a p-value of 0.8733, suggesting that lagged returns have no statistically significant effect on current returns. The R-squared value is extremely low (0.000079), meaning that the model explains virtually none of the variation in returns, and the adjusted R-squared is negative, further confirming the model’s poor fit. The overall model is not statistically significant, as indicated by the F-statistic of 0.02546 and its p-value of 0.8733. In conclusion, there is no meaningful relationship between past and current returns in this dataset.

### 6.Repeat (2) on data from 199706. (Delete all data prior to 199706, then compute lagged returns). Comment briefly

```{r}
data_filtered <- data_filtered %>%
  mutate(
    Rm_lag13 = lag(Portfolio_Returns, 13),  
    Return_Ratio = (Rm_lag / Rm_lag13) - 1 
  )

head(data_filtered, 20)
```

```{r}
model_2 <- lm(Portfolio_Returns ~ Return_Ratio, data = data_filtered)
summary(model_2)
```

```{r, warning=FALSE, message=FALSE}
ggplot(data_filtered, aes(x = Return_Ratio, y = Portfolio_Returns)) +
  geom_point(color = "blue", alpha = 0.6) + 
  geom_smooth(method = "lm", color = "red", se = FALSE) +  
  labs(title = "Regression of Portfolio Returns on Return Ratio (Post-1997)",
       x = "Return Ratio (R_m(t-1) / R_m(t-13) - 1)",
       y = "Portfolio Returns (R_m(t))") +
  theme_minimal()

```

The regression of portfolio returns Rm(t) on the return ratio (R_m(t-1) / R_m(t-13) - 1), using data from June 1997 onward, shows that the intercept is significant, estimated at 0.008568 (about 0.86%) with a t-value of 3.535 and a p-value of 0.00047. However, the coefficient for the return ratio is 7.279e-05, with a t-value of 0.188 and a p-value of 0.85135, indicating that the return ratio is not a significant predictor of current portfolio returns. The R-squared is 0.0001135, meaning that the return ratio explains only a tiny fraction (0.01%) of the variance in the portfolio returns. The adjusted R-squared is negative, further highlighting the poor fit of the model. Overall, the return ratio does not appear to have any meaningful explanatory power for current returns in this dataset.

### 7. Repeat (4) on data from 199706. Comment briefly

```{r}
data_filtered <- data_filtered %>%
  mutate(abs_Rm = abs(Portfolio_Returns))
head(data_filtered)
```

```{r}
model_3 <- lm(Portfolio_Returns ~ abs_Rm, data = data_filtered)
summary(model_3)
```

```{r, warning=FALSE, message=FALSE}
ggplot(data_filtered, aes(x = abs_Rm, y = Portfolio_Returns)) +
  geom_point(color = "blue", alpha = 0.6) +  
  geom_smooth(method = "lm", color = "red", se = FALSE) +  
  labs(title = "Regression of Portfolio Returns on Absolute Returns (Post-1997)",
       x = "Absolute Returns (abs(R_m(t)))",
       y = "Portfolio Returns (R_m(t))") +
  theme_minimal()

```

The regression of portfolio returns Rm(t) on the absolute value of returns absRm(t), using data from June 1997 onward, shows that neither the intercept nor the absolute returns are statistically significant. The intercept is estimated at 0.007406 with a t-value of 1.903 and a p-value of 0.0579, indicating weak statistical significance. The coefficient for absolute returns is 0.050668, with a t-value of 0.562 and a p-value of 0.5742, suggesting no significant relationship between absolute returns and current portfolio returns. The R-squared is 0.0009783, meaning that less than 0.1% of the variation in returns is explained by the model. The adjusted R-squared is negative, further confirming the poor fit of the model. Overall, the absolute returns do not provide meaningful explanatory power for current returns in this dataset.

